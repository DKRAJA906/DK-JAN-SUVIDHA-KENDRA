<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced PDF Data Editor</title>
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f0f2f5; }
        .editor-container { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); max-width: 800px; margin: auto; }
        .control-group { margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #333; }
        input { width: 100%; padding: 8px; margin-bottom: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;}
        button { background: #d9534f; color: white; padding: 10px 20px; border: none; cursor: pointer; border-radius: 4px; font-size: 16px; }
        button.download { background: #28a745; margin-top: 10px; }
        .row { display: flex; gap: 10px; }
        .col { flex: 1; }
        iframe { width: 100%; height: 500px; border: 1px solid #ccc; margin-top: 20px; }
    </style>
</head>
<body>

<div class="editor-container">
    <h2>üõ†Ô∏è PDF Data Modifier (White-out Mode)</h2>
    <p>‡§™‡•Å‡§∞‡§æ‡§®‡•á ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§õ‡•Å‡§™‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§∏ ‡§™‡§∞ ‡§∏‡§´‡§º‡•á‡§¶ ‡§™‡§ü‡•ç‡§ü‡•Ä (White Box) ‡§≤‡§ó‡§æ‡§è‡§Ç ‡§î‡§∞ ‡§®‡§Ø‡§æ ‡§≤‡§ø‡§ñ‡•á‡§Ç‡•§</p>
    
    <!-- Step 1: Upload -->
    <div class="control-group">
        <label>1. PDF ‡§´‡§æ‡§á‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç:</label>
        <input type="file" id="pdfUpload" accept="application/pdf">
    </div>

    <!-- Step 2: Eraser Settings -->
    <div class="control-group">
        <label>2. ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§°‡•á‡§ü‡§æ ‡§Æ‡§ø‡§ü‡§æ‡§è‡§Ç (‡§∏‡§´‡§º‡•á‡§¶ ‡§¨‡•â‡§ï‡•ç‡§∏ ‡§ï‡•Ä ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó):</label>
        <div class="row">
            <div class="col"><input type="number" id="xPos" placeholder="X Position (Left ‡§∏‡•á ‡§¶‡•Ç‡§∞‡•Ä)" value="100"></div>
            <div class="col"><input type="number" id="yPos" placeholder="Y Position (Bottom ‡§∏‡•á ‡§¶‡•Ç‡§∞‡•Ä)" value="600"></div>
        </div>
        <div class="row">
            <div class="col"><input type="number" id="width" placeholder="Box ‡§ï‡•Ä ‡§ö‡•å‡§°‡§º‡§æ‡§à (Width)" value="100"></div>
            <div class="col"><input type="number" id="height" placeholder="Box ‡§ï‡•Ä ‡§ä‡§Ç‡§ö‡§æ‡§à (Height)" value="20"></div>
        </div>
        <small>‡§®‡§Ç‡§¨‡§∞ ‡§¨‡§¶‡§≤‡§ï‡§∞ ‡§¨‡•â‡§ï‡•ç‡§∏ ‡§ï‡•ã ‡§∏‡§π‡•Ä ‡§ú‡§ó‡§π ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§</small>
    </div>

    <!-- Step 3: New Data -->
    <div class="control-group">
        <label>3. ‡§®‡§Ø‡§æ ‡§°‡•á‡§ü‡§æ ‡§≤‡§ø‡§ñ‡•á‡§Ç:</label>
        <input type="text" id="newText" placeholder="‡§ú‡•à‡§∏‡•á: ‡§®‡§Ø‡§æ ‡§®‡§æ‡§Æ ‡§Ø‡§æ ‡§®‡§Ç‡§¨‡§∞">
        <input type="number" id="fontSize" value="12" placeholder="Font Size">
    </div>

    <button onclick="modifyPdf()">Preview & Update PDF</button>
    <button class="download" onclick="downloadPdf()">Download Final PDF</button>
</div>

<iframe id="pdfPreview"></iframe>

<script>
    const { PDFDocument, rgb } = PDFLib;
    let modifiedPdfBytes = null;

    async function modifyPdf() {
        const fileInput = document.getElementById('pdfUpload');
        if (!fileInput.files[0]) { alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á PDF ‡§´‡§æ‡§á‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç!"); return; }

        const fileBytes = await fileInput.files[0].arrayBuffer();
        const pdfDoc = await PDFDocument.load(fileBytes);
        const pages = pdfDoc.getPages();
        const firstPage = pages[0]; // ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§™‡§π‡§≤‡•á ‡§™‡•á‡§ú ‡§™‡§∞ ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡•á‡§ó‡§æ

        // 1. Data Get Karen
        const x = Number(document.getElementById('xPos').value);
        const y = Number(document.getElementById('yPos').value);
        const w = Number(document.getElementById('width').value);
        const h = Number(document.getElementById('height').value);
        const text = document.getElementById('newText').value;
        const fSize = Number(document.getElementById('fontSize').value);

        // 2. Draw White Rectangle (Eraser) - Ye purane text ko chupayega
        firstPage.drawRectangle({
            x: x,
            y: y,
            width: w,
            height: h,
            color: rgb(1, 1, 1), // White Color
        });

        // 3. Draw New Text - Usi ke upar naya text likhega
        if(text) {
            firstPage.drawText(text, {
                x: x + 2, // Thoda margin
                y: y + 2, // Thoda margin
                size: fSize,
                color: rgb(0, 0, 0), // Black Text
            });
        }

        // 4. Save and Show Preview
        modifiedPdfBytes = await pdfDoc.save();
        const blob = new Blob([modifiedPdfBytes], { type: 'application/pdf' });
        const url = URL.createObjectURL(blob);
        document.getElementById('pdfPreview').src = url;
    }

    function downloadPdf() {
        if (!modifiedPdfBytes) { alert("‡§™‡§π‡§≤‡•á Preview ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç!"); return; }
        const blob = new Blob([modifiedPdfBytes], { type: 'application/pdf' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'edited_document.pdf';
        link.click();
    }
</script>

</body>
</html>
